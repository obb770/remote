<!DOCTYPE html>
<html>
 <head>
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style"
    content="black-translucent" />
  <link rel="apple-touch-icon-precomposed" href="/png?name=touch-icon" />
  <style type="text/css">
#ui {
    margin-top: 40px;
    font-size: 166%;
    font-family: sans-serif;
}
#list {
    width: 99%;
    -webkit-appearance: none;
    font-size: inherit;
}
#selected {
    margin-top: 1em;
    font-size: inherit;
}
.buttontable {
}
.buttonrow {
    margin: 1em 0;
}
.button {
    padding: 1em 0;
    -webkit-appearance: none;
    -webkit-border-radius: 10px;
    background-color: green;
}
.left {
    width: 31%;
}
.middle {
    width: 32%;
}
.right {
    width: 31%;
}
#error {
    font-family: monospace;
    font-size: .5em;
}
  </style>
  <title>OMXRemote</title>
 </head>
 <body>
  <div id="ui">
   <div class="buttontable">
   <div class="buttonrow">
    <button id="seekminus30" class="button left"><img width="64px"
      src="/svg?name=media-seek-backward"></button>
    <button id="pauseorresume" class="button middle"><img width="64px"
      src="/svg?name=media-playback-pause"></button>
    <button id="seekplus30" class="button right"><img width="64px"
      src="/svg?name=media-seek-forward"></button>
   </div>
   <div class="buttonrow">
    <button id="play" class="button left"><img width="64px"
      src="/svg?name=media-playback-start"></button>
    <button id="reload" class="button middle"><img width="64px"
      src="/svg?name=view-refresh"></button>
    <button id="stop" class="button right"><img width="64px"
      src="/svg?name=media-playback-stop"></button>
   </div>
   <div>
    <select id="list" class="utton">
    </select>
   </div>
   <div id="selected">
   </div>
   </div>
   <div id="error">
   </div>
  </div>
  <script type="text/javascript">
(function () {
'use strict';
var qs = function (q) {return document.querySelector(q);},
    request,
    populateList,
    file = null,
    dummy;

function request(op, args) {
    var xhr = new XMLHttpRequest(),
        url = op,
        key,
        params = [];
    for (key in args) {
        if (args.hasOwnProperty(key)) {
            params.push(key + '=' + encodeURIComponent(args[key]));
        }
    }
    url = url + '?' + params.join('&');
    qs('#error').innerHTML = '';
    xhr.open('GET', url, false);
    xhr.send();
    if (xhr.status != 200) {
        qs('#error').innerHTML = xhr.responseText;
        return null;
    }
    return JSON.parse(xhr.responseText);
};

populateList = function (listElement) {
    var list = request('/list', {});
    listElement.innerHTML =
        '<option>' + 'Click to select media...' + '</option>' + 
        '<option>' + list.join('</option><option>') + '</option>';
};

populateList(qs('#list'));
qs('#list').addEventListener('change', function (e) {
    var list = qs('#list');
    file = list.options[list.selectedIndex].textContent;
    qs('#selected').innerHTML = file.replace(/\./g, ' ');
    setTimeout(function () {
        qs('#list').selectedIndex = 0;
        qs('#list').value = list.options[list.selectedIndex].textContent;
    }, 0);
});
qs('#seekminus30').addEventListener('click', function () {
    request('/control', {'command': 'seekMinus30'});
});
qs('#pauseorresume').addEventListener('click', function () {
    request('/control', {'command': 'pauseOrResume'});
});
qs('#seekplus30').addEventListener('click', function () {
    request('/control', {'command': 'seekPlus30'});
});
qs('#play').addEventListener('click', function () {
    var list = qs('#list');
    request('/play', {'file': file});
});
qs('#reload').addEventListener('click', function () {
    populateList(qs('#list'));
});
qs('#stop').addEventListener('click', function () {
    request('/control', {'command': 'exitOMXPlayer'});
});

}());
  </script>
 </body>
</html>
